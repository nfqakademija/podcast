{% extends 'front/layout/main.html.twig' %}

{% block content %}
 <div class="col-sm-8">
          <div class="blog classic-view single">
            <div class="post">
              <span class="category"><a href="{{ url('podcasts_by_source', {slug: podcast.source.slug}) }}" class="label bg-lime" target="_blank">
                {{ podcast.source.name}} </a></span>
              <div class="post-content">
                <h1 class="post-title">{{ podcast.title }}</h1>
                <div><span class="date">{{ podcast.publishedAt|date("M d, Y") }}</span>
                 
                </div>
                {% if podcast.audio != null %}
                <p>
                    <audio controls class="entry-read-more1">
                        <source src="{{ podcast.audio}}" type="audio/mp3">
                        Your browser does not support the audio element.
                    </audio>
                </p>
                {% endif %}
                {% if podcast.video != null %}
                <div class="video-container">
                  <iframe width="560" height="315" src="https://www.youtube.com/embed/{{ podcast.video }}"
                      frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope;"
                      allowfullscreen>
                  </iframe>
                </div>
                {% endif %}
                <p> {{ podcast.description }}</p>
                {% if app.user %}
                <div class="pull-left">

                        <button href="#" class="btn btn-rounded btn-icon btn-icon-left btn-like {% if app.user.isLike(podcast) %}active{% endif %}" onclick="toogle(this)">
                            <span class="counter counter-left ">
                                {{ podcast.likesByUser|length }}
                            </span>
                            <i class="et-thumbs-up"></i>Patinka
                        </button>
                </div>
                {% endif %}

                <div class="space10"></div>
     
                <!-- /.tiles -->                
                <div class="clearfix"></div>

              </div>
              <!-- /.post-content --> 
              
            </div>

            <div class="clearfix"></div>
              {% if app.user %}
                {{ include('front/pages/posts/_comment_box.html.twig') }}
              {% endif %}

              {% if comments|length > 0 %}
              <hr />
                {{ include('front/pages/posts/_comments.html.twig') }}
              {% endif %}
            
          </div>
          <!-- /.blog --> 
          
        </div>

{% endblock %}

{% block sidebar %}
    {{ render(controller('App\\Controller\\PublicController::getNavigationBar')) }}
{% endblock %}

{% block javascript %}
{% if app.user %}
<script
    src="https://code.jquery.com/jquery-3.4.1.js"
    integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
    crossorigin="anonymous"
    >
</script>
    <script>

        function toogle(item)
        {
            $.get( "{{ path('like', {'podcast': podcast.id}) }}", function( data ) {


                if (data.likes) {
                    item.classList.add('active');
                    $('.counter', item).html(data.countLikes);
                } else {
                    item.classList.remove('active');
                    $('.counter', item).html(data.countLikes);
                }

            });
        }
    </script>
{% endif %}
{% endblock %}